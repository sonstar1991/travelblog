{"ast":null,"code":"import _Object$defineProperty from \"@babel/runtime-corejs2/core-js/object/define-property\";\nimport _Object$defineProperties from \"@babel/runtime-corejs2/core-js/object/define-properties\";\nimport _Object$getOwnPropertyDescriptors from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptors\";\nimport _Object$getOwnPropertyDescriptor from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptor\";\nimport _Object$getOwnPropertySymbols from \"@babel/runtime-corejs2/core-js/object/get-own-property-symbols\";\nimport _Object$keys from \"@babel/runtime-corejs2/core-js/object/keys\";\nimport _toConsumableArray from \"@babel/runtime-corejs2/helpers/esm/toConsumableArray\";\nimport _JSON$stringify from \"@babel/runtime-corejs2/core-js/json/stringify\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/Users/huirenchuah/Desktop/travelblog/frontend/components/crud/BlogCreate.js\";\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = _Object$keys(object); if (_Object$getOwnPropertySymbols) { var symbols = _Object$getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return _Object$getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (_Object$getOwnPropertyDescriptors) { _Object$defineProperties(target, _Object$getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { _Object$defineProperty(target, key, _Object$getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport Link from \"next/link\";\nimport { useState, useEffect } from \"react\";\nimport Router from \"next/router\";\nimport dynamic from \"next/dynamic\";\nimport { withRouter } from \"next/router\";\nimport { getCookie, isAuth } from \"../../actions/auth\";\nimport { getCategories } from \"../../actions/category\";\nimport { getTags } from \"../../actions/tag\";\nimport { createBlog } from \"../../actions/blog\";\nimport \"../../node_modules/react-quill/dist/quill.snow.css\"; //close ssr\n\nvar ReactQuill = dynamic(function () {\n  return import(\"react-quill\");\n}, {\n  ssr: false,\n  loadableGenerated: {\n    webpack: function webpack() {\n      return [require.resolveWeak(\"react-quill\")];\n    },\n    modules: [\"react-quill\"]\n  }\n});\n\nvar CreateBlog = function CreateBlog(_ref) {\n  var router = _ref.router;\n\n  var blogFromLS = function blogFromLS() {\n    if (false) {\n      return false;\n    }\n\n    if (localStorage.getItem(\"blog\")) {\n      return JSON.parse(localStorage.getItem(\"blog\"));\n    } else {\n      return false;\n    }\n  }; // const titleFromLS = () => {\n  //   if (typeof window === \"undefined\") {\n  //     return false;\n  //   }\n  //   if (localStorage.getItem(\"title\")) {\n  //     return JSON.parse(localStorage.getItem(\"title\"));\n  //   } else {\n  //     return false;\n  //   }\n  // };\n\n\n  var _useState = useState([]),\n      categories = _useState[0],\n      setCategories = _useState[1];\n\n  var _useState2 = useState([]),\n      tags = _useState2[0],\n      setTags = _useState2[1];\n\n  var _useState3 = useState([]),\n      checked = _useState3[0],\n      setChecked = _useState3[1]; //categories\n\n\n  var _useState4 = useState([]),\n      checkedTag = _useState4[0],\n      setCheckedTag = _useState4[1]; //tag\n\n\n  var _useState5 = useState(blogFromLS()),\n      body = _useState5[0],\n      setBody = _useState5[1]; //   const [head, setHead] = useState(titleFromLS());\n\n\n  var _useState6 = useState({\n    error: \"\",\n    sizeError: \"\",\n    success: \"\",\n    formData: \"\",\n    title: \"\",\n    hidePublishButton: false\n  }),\n      values = _useState6[0],\n      setValues = _useState6[1];\n\n  var error = values.error,\n      sizeError = values.sizeError,\n      success = values.success,\n      formData = values.formData,\n      title = values.title,\n      hidePublishButton = values.hidePublishButton; //if anything reloads the router we will still get it running\n\n  useEffect(function () {\n    setValues(_objectSpread({}, values, {\n      formData: new FormData()\n    })), initCategories(), initTags();\n  }, [router]);\n\n  var initCategories = function initCategories() {\n    getCategories().then(function (data) {\n      if (data.error) {\n        setValues(_objectSpread({}, values, {\n          error: data.error\n        }));\n      } else {\n        setCategories(data);\n      }\n    });\n  };\n\n  var initTags = function initTags() {\n    getTags().then(function (data) {\n      if (data.error) {\n        setValues(_objectSpread({}, values, {\n          error: data.error\n        }));\n      } else {\n        setTags(data);\n      }\n    });\n  };\n\n  var publishBlog = function publishBlog(e) {\n    e.preventDefault();\n    console.log(\"ready\");\n  };\n\n  var handleChange = function handleChange(name) {\n    return function (e) {\n      var _objectSpread2;\n\n      // console.log(e.target.value);\n      // setHead(name)\n      var value = name === \"photo\" ? e.target.files[0] : e.target.value;\n      formData.set(name, value); // if (typeof window !== \"undefined\") {\n      //     localStorage.setItem(\"title\", name);\n      //   }\n\n      setValues(_objectSpread({}, values, (_objectSpread2 = {}, _defineProperty(_objectSpread2, name, value), _defineProperty(_objectSpread2, \"formData\", formData), _defineProperty(_objectSpread2, \"error\", \"\"), _objectSpread2)));\n    };\n  };\n\n  var handleBody = function handleBody(e) {\n    // console.log(e);\n    setBody(e);\n    formData.set(\"body\", e);\n\n    if (true) {\n      localStorage.setItem(\"blog\", _JSON$stringify(e));\n    }\n  };\n\n  var handleToggle = function handleToggle(c) {\n    return function () {\n      setValues(_objectSpread({}, values, {\n        error: ''\n      })); //return the first index or -1\n\n      var clickedCategory = checked.indexOf(c);\n\n      var all = _toConsumableArray(checked);\n\n      if (clickedCategory === -1) {\n        all.push(c);\n      } else {\n        all.splice(clickedCategory, 1);\n      }\n\n      console.log(all);\n      setChecked(all);\n      formData.set('categories', all);\n    };\n  };\n\n  var handleToggles = function handleToggles(t) {\n    return function () {\n      setValues(_objectSpread({}, values, {\n        error: ''\n      })); //return the first index or -1\n\n      var clickedCategory = checked.indexOf(t);\n\n      var all = _toConsumableArray(checked);\n\n      if (clickedCategory === -1) {\n        all.push(t);\n      } else {\n        all.splice(clickedCategory, 1);\n      }\n\n      console.log(all);\n      setChecked(all);\n      formData.set('categories', all);\n    };\n  };\n\n  var showCategories = function showCategories() {\n    return categories && categories.map(function (c, i) {\n      return __jsx(\"li\", {\n        key: i,\n        className: \"list-unstyled\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 160\n        },\n        __self: this\n      }, __jsx(\"input\", {\n        onChange: handleToggle(c._id),\n        type: \"checkbox\",\n        className: \"mr-2\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 161\n        },\n        __self: this\n      }), __jsx(\"label\", {\n        className: \"form-check-label\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 162\n        },\n        __self: this\n      }, c.name));\n    });\n  };\n\n  var showTags = function showTags() {\n    return tags && tags.map(function (t, i) {\n      return __jsx(\"li\", {\n        key: i,\n        className: \"list-unstyled\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 172\n        },\n        __self: this\n      }, __jsx(\"input\", {\n        onChange: handleToggles(t._id),\n        type: \"checkbox\",\n        className: \"mr-2\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 173\n        },\n        __self: this\n      }), __jsx(\"label\", {\n        className: \"form-check-label\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 174\n        },\n        __self: this\n      }, t.name));\n    });\n  };\n\n  var createBlogForm = function createBlogForm() {\n    return __jsx(\"form\", {\n      onSubmit: publishBlog,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182\n      },\n      __self: this\n    }, __jsx(\"div\", {\n      className: \"form-group\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183\n      },\n      __self: this\n    }, __jsx(\"label\", {\n      className: \"text-muted\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184\n      },\n      __self: this\n    }, \"Title\"), __jsx(\"input\", {\n      type: \"text\",\n      className: \"form-control\",\n      onChange: handleChange(\"title\"),\n      value: title,\n      placeholder: \"Type your blog title\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185\n      },\n      __self: this\n    })), __jsx(\"div\", {\n      className: \"form-group\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 193\n      },\n      __self: this\n    }, __jsx(ReactQuill, {\n      modules: CreateBlog.modules,\n      formats: CreateBlog.formats,\n      value: body,\n      placeholder: \"Write your experience...\",\n      onChange: handleBody,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194\n      },\n      __self: this\n    })), __jsx(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 202\n      },\n      __self: this\n    }, __jsx(\"button\", {\n      className: \"btn btn-primary\",\n      type: \"submit\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 203\n      },\n      __self: this\n    }, \"Publish\")));\n  };\n\n  return __jsx(\"div\", {\n    className: \"container-fluid\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 212\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"row\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 213\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"col-md-8\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 214\n    },\n    __self: this\n  }, createBlogForm(), __jsx(\"hr\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 216\n    },\n    __self: this\n  }), _JSON$stringify({\n    title: title\n  }), __jsx(\"hr\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 218\n    },\n    __self: this\n  }), _JSON$stringify({\n    tags: tags\n  }), __jsx(\"hr\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 220\n    },\n    __self: this\n  }), _JSON$stringify({\n    categories: categories\n  })), __jsx(\"div\", {\n    className: \"col-md-4\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 223\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"mb-3\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 224\n    },\n    __self: this\n  }, __jsx(\"h2\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 225\n    },\n    __self: this\n  }, \"Categories\"), __jsx(\"hr\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 226\n    },\n    __self: this\n  }), __jsx(\"ul\", {\n    style: {\n      maxHeight: \"200px\",\n      overflowY: \"scroll\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 227\n    },\n    __self: this\n  }, showCategories())), __jsx(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 231\n    },\n    __self: this\n  }, __jsx(\"h2\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 232\n    },\n    __self: this\n  }, \"Tags\"), __jsx(\"hr\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 233\n    },\n    __self: this\n  }), __jsx(\"ul\", {\n    style: {\n      maxHeight: \"200px\",\n      overflowY: \"scroll\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 234\n    },\n    __self: this\n  }, showTags())))));\n};\n\nCreateBlog.modules = {\n  toolbar: [[{\n    header: \"1\"\n  }, {\n    header: \"2\"\n  }, {\n    header: [3, 4, 5, 6]\n  }, {\n    font: []\n  }], [{\n    size: []\n  }], [\"bold\", \"italic\", \"underline\", \"strike\", \"blockquote\"], [{\n    list: \"ordered\"\n  }, {\n    list: \"bullet\"\n  }], [\"link\", \"image\", \"video\"], [\"clean\"], [\"code-block\"]]\n};\nCreateBlog.formats = [\"header\", \"font\", \"size\", \"bold\", \"italic\", \"underline\", \"strike\", \"blockquote\", \"list\", \"bullet\", \"link\", \"image\", \"video\", \"code-block\"];\nexport default withRouter(CreateBlog);","map":{"version":3,"sources":["/Users/huirenchuah/Desktop/travelblog/frontend/components/crud/BlogCreate.js"],"names":["Link","useState","useEffect","Router","dynamic","withRouter","getCookie","isAuth","getCategories","getTags","createBlog","ReactQuill","ssr","CreateBlog","router","blogFromLS","localStorage","getItem","JSON","parse","categories","setCategories","tags","setTags","checked","setChecked","checkedTag","setCheckedTag","body","setBody","error","sizeError","success","formData","title","hidePublishButton","values","setValues","FormData","initCategories","initTags","then","data","publishBlog","e","preventDefault","console","log","handleChange","name","value","target","files","set","handleBody","setItem","handleToggle","c","clickedCategory","indexOf","all","push","splice","handleToggles","t","showCategories","map","i","_id","showTags","createBlogForm","modules","formats","maxHeight","overflowY","toolbar","header","font","size","list"],"mappings":"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","sourcesContent":["import Link from \"next/link\";\nimport { useState, useEffect } from \"react\";\nimport Router from \"next/router\";\nimport dynamic from \"next/dynamic\";\nimport { withRouter } from \"next/router\";\nimport { getCookie, isAuth } from \"../../actions/auth\";\nimport { getCategories } from \"../../actions/category\";\nimport { getTags } from \"../../actions/tag\";\nimport { createBlog } from \"../../actions/blog\";\nimport \"../../node_modules/react-quill/dist/quill.snow.css\";\n//close ssr\nconst ReactQuill = dynamic(() => import(\"react-quill\"), { ssr: false });\n\nconst CreateBlog = ({ router }) => {\n  const blogFromLS = () => {\n    if (typeof window === \"undefined\") {\n      return false;\n    }\n    if (localStorage.getItem(\"blog\")) {\n      return JSON.parse(localStorage.getItem(\"blog\"));\n    } else {\n      return false;\n    }\n  };\n  \n    // const titleFromLS = () => {\n    //   if (typeof window === \"undefined\") {\n    //     return false;\n    //   }\n    //   if (localStorage.getItem(\"title\")) {\n    //     return JSON.parse(localStorage.getItem(\"title\"));\n    //   } else {\n    //     return false;\n    //   }\n    // };\n\n  const [categories, setCategories] = useState([]);\n  const [tags, setTags] = useState([]);\n\n  const[checked,setChecked]=useState([])//categories\n  const[checkedTag,setCheckedTag]=useState([])//tag\n\n  const [body, setBody] = useState(blogFromLS());\n\n//   const [head, setHead] = useState(titleFromLS());\n\n\n  const [values, setValues] = useState({\n    error: \"\",\n    sizeError: \"\",\n    success: \"\",\n    formData: \"\",\n    title: \"\",\n    hidePublishButton: false\n  });\n\n  const {\n    error,\n    sizeError,\n    success,\n    formData,\n    title,\n    hidePublishButton\n  } = values;\n\n  //if anything reloads the router we will still get it running\n  useEffect(() => {\n    setValues({ ...values, formData: new FormData() }),\n      initCategories(),\n      initTags();\n  }, [router]);\n\n  const initCategories = () => {\n    getCategories().then(data => {\n      if (data.error) {\n        setValues({ ...values, error: data.error });\n      } else {\n        setCategories(data);\n      }\n    });\n  };\n\n  const initTags = () => {\n    getTags().then(data => {\n      if (data.error) {\n        setValues({ ...values, error: data.error });\n      } else {\n        setTags(data);\n      }\n    });\n  };\n\n  const publishBlog = e => {\n    e.preventDefault();\n    console.log(\"ready\");\n  };\n\n  const handleChange = name => e => {\n    // console.log(e.target.value);\n// setHead(name)\n    const value = name === \"photo\" ? e.target.files[0] : e.target.value;\n    formData.set(name, value);\n    // if (typeof window !== \"undefined\") {\n    //     localStorage.setItem(\"title\", name);\n    //   }\n    setValues({ ...values, [name]: value, formData, error: \"\" });\n   \n  };\n\n  const handleBody = e => {\n    // console.log(e);\n    setBody(e);\n    formData.set(\"body\", e);\n    if (typeof window !== \"undefined\") {\n      localStorage.setItem(\"blog\", JSON.stringify(e));\n    }\n  };\n\n\n const handleToggle =c => ()=>{\n     setValues({...values, error:''})\n    \n     //return the first index or -1\n     const clickedCategory = checked.indexOf(c)\n     const all = [...checked]\n     if(clickedCategory=== -1){\n         all.push(c)\n     }else{\n         all.splice(clickedCategory,1)\n     }\n     console.log(all)\n     setChecked(all)\n     formData.set('categories', all)\n }\n\n\n const handleToggles =t => ()=>{\n    setValues({...values, error:''})\n   \n    //return the first index or -1\n    const clickedCategory = checked.indexOf(t)\n    const all = [...checked]\n    if(clickedCategory=== -1){\n        all.push(t)\n    }else{\n        all.splice(clickedCategory,1)\n    }\n    console.log(all)\n    setChecked(all)\n    formData.set('categories', all)\n}\n\n\n\n\n  const showCategories = () => {\n    return (\n      categories &&\n      categories.map((c, i) => (\n        <li key={i} className=\"list-unstyled\">\n          <input onChange={handleToggle(c._id)} type=\"checkbox\" className=\"mr-2\" />\n          <label className=\"form-check-label\">{c.name}</label>\n        </li>\n      ))\n    );\n  };\n\n  const showTags = () => {\n    return (\n      tags &&\n      tags.map((t, i) => (\n        <li key={i} className=\"list-unstyled\">\n          <input onChange={handleToggles(t._id)} type=\"checkbox\" className=\"mr-2\" />\n          <label className=\"form-check-label\">{t.name}</label>\n        </li>\n      ))\n    );\n  };\n\n  const createBlogForm = () => {\n    return (\n      <form onSubmit={publishBlog}>\n        <div className=\"form-group\">\n          <label className=\"text-muted\">Title</label>\n          <input\n            type=\"text\"\n            className=\"form-control\"\n            onChange={handleChange(\"title\")}\n            value={title}\n            placeholder=\"Type your blog title\"\n          ></input>\n        </div>\n        <div className=\"form-group\">\n          <ReactQuill\n            modules={CreateBlog.modules}\n            formats={CreateBlog.formats}\n            value={body}\n            placeholder=\"Write your experience...\"\n            onChange={handleBody}\n          />\n        </div>\n        <div>\n          <button className=\"btn btn-primary\" type=\"submit\">\n            Publish\n          </button>\n        </div>\n      </form>\n    );\n  };\n\n  return (\n    <div className=\"container-fluid\">\n      <div className=\"row\">\n        <div className=\"col-md-8\">\n          {createBlogForm()}\n          <hr />\n          {JSON.stringify({ title })}\n          <hr />\n          {JSON.stringify({ tags })}\n          <hr />\n          {JSON.stringify({ categories })}\n        </div>\n        <div className=\"col-md-4\">\n          <div className=\"mb-3\">\n            <h2>Categories</h2>\n            <hr />\n            <ul style={{ maxHeight: \"200px\", overflowY: \"scroll\" }}>\n              {showCategories()}\n            </ul>\n          </div>\n          <div>\n            <h2>Tags</h2>\n            <hr />\n            <ul style={{ maxHeight: \"200px\", overflowY: \"scroll\" }}>\n              {showTags()}\n            </ul>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nCreateBlog.modules = {\n  toolbar: [\n    [{ header: \"1\" }, { header: \"2\" }, { header: [3, 4, 5, 6] }, { font: [] }],\n    [{ size: [] }],\n    [\"bold\", \"italic\", \"underline\", \"strike\", \"blockquote\"],\n    [{ list: \"ordered\" }, { list: \"bullet\" }],\n    [\"link\", \"image\", \"video\"],\n    [\"clean\"],\n    [\"code-block\"]\n  ]\n};\n\nCreateBlog.formats = [\n  \"header\",\n  \"font\",\n  \"size\",\n  \"bold\",\n  \"italic\",\n  \"underline\",\n  \"strike\",\n  \"blockquote\",\n  \"list\",\n  \"bullet\",\n  \"link\",\n  \"image\",\n  \"video\",\n  \"code-block\"\n];\n\nexport default withRouter(CreateBlog);\n"]},"metadata":{},"sourceType":"module"}