{"ast":null,"code":"import _Object$defineProperty from \"@babel/runtime-corejs2/core-js/object/define-property\";\nimport _Object$defineProperties from \"@babel/runtime-corejs2/core-js/object/define-properties\";\nimport _Object$getOwnPropertyDescriptors from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptors\";\nimport _Object$getOwnPropertyDescriptor from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptor\";\nimport _Object$getOwnPropertySymbols from \"@babel/runtime-corejs2/core-js/object/get-own-property-symbols\";\nimport _Object$keys from \"@babel/runtime-corejs2/core-js/object/keys\";\nimport _toConsumableArray from \"@babel/runtime-corejs2/helpers/esm/toConsumableArray\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/Users/huirenchuah/Desktop/travelblog/frontend/components/auth/ProfileUpdate.js\";\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = _Object$keys(object); if (_Object$getOwnPropertySymbols) { var symbols = _Object$getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return _Object$getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (_Object$getOwnPropertyDescriptors) { _Object$defineProperties(target, _Object$getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { _Object$defineProperty(target, key, _Object$getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport Link from \"next/link\";\nimport { useState, useEffect } from \"react\";\nimport Router from \"next/router\";\nimport { getCookie, isAuth, updateUser } from \"../../actions/auth\";\nimport { getProfile, update } from \"../../actions/user\";\nimport { API } from \"../../config\";\nimport ReactImageFallback from \"react-image-fallback\";\nimport { Button } from \"@material-ui/core\";\nimport CloudUploadIcon from '@material-ui/icons/CloudUpload';\n\nvar ProfileUpdate = function ProfileUpdate() {\n  var _useState = useState({\n    username: \"\",\n    name: \"\",\n    email: \"\",\n    about: \"\",\n    password: \"\",\n    error: false,\n    success: false,\n    loading: false,\n    userData: true && new FormData(),\n    username_for_photo: \"\"\n  }),\n      values = _useState[0],\n      setValues = _useState[1];\n\n  var token = getCookie(\"token\");\n  var username = values.username,\n      name = values.name,\n      email = values.email,\n      about = values.about,\n      password = values.password,\n      error = values.error,\n      success = values.success,\n      loading = values.loading,\n      username_for_photo = values.username_for_photo,\n      userData = values.userData;\n\n  var init = function init() {\n    getProfile(token).then(function (data) {\n      if (data.error) {\n        setValues(_objectSpread({}, values, {\n          error: data.error\n        }));\n      } else {\n        setValues(_objectSpread({}, values, {\n          username: data.username,\n          username_for_photo: data.username,\n          name: data.name,\n          email: data.email,\n          about: data.about\n        }));\n      }\n    });\n  };\n\n  useEffect(function () {\n    init();\n    setValues(_objectSpread({}, values, {\n      userData: new FormData()\n    }));\n  }, []);\n\n  var handleChange = function handleChange(name) {\n    return function (e) {\n      var _objectSpread2;\n\n      // console.log(e.target.value);\n      var value = name === \"photo\" ? e.target.files[0] : e.target.value;\n      userData.set(name, value);\n      setValues(_objectSpread({}, values, (_objectSpread2 = {}, _defineProperty(_objectSpread2, name, value), _defineProperty(_objectSpread2, \"userData\", userData), _defineProperty(_objectSpread2, \"error\", false), _defineProperty(_objectSpread2, \"success\", false), _objectSpread2))); // console.log(...userData)\n    };\n  };\n\n  var handleSubmit = function handleSubmit(e) {\n    var _console;\n\n    e.preventDefault();\n\n    (_console = console).log.apply(_console, _toConsumableArray(userData));\n\n    setValues(_objectSpread({}, values, {\n      loading: true\n    }));\n    update(token, userData).then(function (data) {\n      if (data.error) {\n        setValues(_objectSpread({}, values, {\n          error: data.error,\n          success: false,\n          loading: false\n        }));\n      } else {\n        // console.log(data)\n        updateUser(data, function () {\n          setValues(_objectSpread({}, values, {\n            // usernameImgSrc: data.username,\n            username: data.username,\n            name: data.name,\n            email: data.email,\n            about: data.about,\n            password: \"\",\n            success: true,\n            loading: false\n          }));\n        });\n      }\n    });\n  };\n\n  var profileUpdateForm = function profileUpdateForm() {\n    return __jsx(\"form\", {\n      onSubmit: handleSubmit,\n      className: \"pl-5\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110\n      },\n      __self: this\n    }, __jsx(\"div\", {\n      className: \"form-group\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111\n      },\n      __self: this\n    }, __jsx(Button, {\n      variant: \"contained\",\n      color: \"default\",\n      startIcon: __jsx(CloudUploadIcon, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 116\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112\n      },\n      __self: this\n    }, __jsx(\"label\", {\n      className: \"\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118\n      },\n      __self: this\n    }, \"Featured photo\", __jsx(\"input\", {\n      onChange: handleChange(\"photo\"),\n      type: \"file\",\n      accept: \"image/*\",\n      hidden: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121\n      },\n      __self: this\n    })))), __jsx(\"div\", {\n      className: \"form-group\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131\n      },\n      __self: this\n    }, __jsx(\"label\", {\n      className: \"text-muted\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132\n      },\n      __self: this\n    }, \"Username\"), __jsx(\"input\", {\n      onChange: handleChange(\"username\"),\n      type: \"text\",\n      value: username,\n      className: \"form-control\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133\n      },\n      __self: this\n    })), __jsx(\"div\", {\n      className: \"form-group\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140\n      },\n      __self: this\n    }, __jsx(\"label\", {\n      className: \"text-muted\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141\n      },\n      __self: this\n    }, \"Name\"), __jsx(\"input\", {\n      onChange: handleChange(\"name\"),\n      type: \"text\",\n      value: name,\n      className: \"form-control\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142\n      },\n      __self: this\n    })), __jsx(\"div\", {\n      className: \"form-group\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149\n      },\n      __self: this\n    }, __jsx(\"label\", {\n      className: \"text-muted\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150\n      },\n      __self: this\n    }, \"Email\"), __jsx(\"input\", {\n      onChange: handleChange(\"email\"),\n      type: \"text\",\n      value: email,\n      className: \"form-control\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151\n      },\n      __self: this\n    })), __jsx(\"div\", {\n      className: \"form-group\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158\n      },\n      __self: this\n    }, __jsx(\"label\", {\n      className: \"text-muted\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159\n      },\n      __self: this\n    }, \"About\"), __jsx(\"textarea\", {\n      onChange: handleChange(\"about\"),\n      type: \"text\",\n      value: about,\n      className: \"form-control\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 160\n      },\n      __self: this\n    })), __jsx(\"div\", {\n      className: \"form-group\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 167\n      },\n      __self: this\n    }, __jsx(\"label\", {\n      className: \"text-muted\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168\n      },\n      __self: this\n    }, \"Password\"), __jsx(\"input\", {\n      onChange: handleChange(\"password\"),\n      type: \"password\",\n      value: password,\n      className: \"form-control\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169\n      },\n      __self: this\n    })), __jsx(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176\n      },\n      __self: this\n    }, __jsx(Button, {\n      variant: \"contained\",\n      color: \"primary\",\n      type: \"submit\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177\n      },\n      __self: this\n    }, \"Submit\")));\n  };\n\n  var showError = function showError() {\n    return __jsx(\"div\", {\n      className: \"alert alert-danger\",\n      style: {\n        display: error ? \"\" : \"none\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185\n      },\n      __self: this\n    }, error);\n  };\n\n  var showSuccess = function showSuccess() {\n    return __jsx(\"div\", {\n      className: \"alert alert-success\",\n      style: {\n        display: success ? \"\" : \"none\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194\n      },\n      __self: this\n    }, \"Profile updated\");\n  };\n\n  var showLoading = function showLoading() {\n    return __jsx(\"div\", {\n      className: \"alert alert-info\",\n      style: {\n        display: loading ? \"\" : \"none\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 203\n      },\n      __self: this\n    }, \"Loading...\");\n  };\n\n  return __jsx(React.Fragment, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 212\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"container\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 213\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"row\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 214\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"col-md-4 mt-5\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 215\n    },\n    __self: this\n  }, __jsx(ReactImageFallback, {\n    src: \"\".concat(API, \"/user/photo/\").concat(username_for_photo),\n    className: \"img img-fluid img-thumbnail mb-3\",\n    fallbackImage: \"/static/default.svg\",\n    style: {\n      maxHeight: \"auto\",\n      maxWidth: \"100%\"\n    },\n    alt: \"user profile\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 216\n    },\n    __self: this\n  })), __jsx(\"div\", {\n    className: \"col-md-8  mt-5\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 224\n    },\n    __self: this\n  }, showSuccess(), showError(), showLoading(), profileUpdateForm()))));\n};\n\nexport default ProfileUpdate;","map":{"version":3,"sources":["/Users/huirenchuah/Desktop/travelblog/frontend/components/auth/ProfileUpdate.js"],"names":["Link","useState","useEffect","Router","getCookie","isAuth","updateUser","getProfile","update","API","ReactImageFallback","Button","CloudUploadIcon","ProfileUpdate","username","name","email","about","password","error","success","loading","userData","FormData","username_for_photo","values","setValues","token","init","then","data","handleChange","e","value","target","files","set","handleSubmit","preventDefault","console","log","profileUpdateForm","showError","display","showSuccess","showLoading","maxHeight","maxWidth"],"mappings":"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","sourcesContent":["import Link from \"next/link\";\nimport { useState, useEffect } from \"react\";\nimport Router from \"next/router\";\nimport { getCookie, isAuth, updateUser } from \"../../actions/auth\";\nimport { getProfile, update } from \"../../actions/user\";\nimport { API } from \"../../config\";\nimport ReactImageFallback from \"react-image-fallback\";\nimport { Button } from \"@material-ui/core\";\nimport CloudUploadIcon from '@material-ui/icons/CloudUpload';\n\nconst ProfileUpdate = () => {\n  const [values, setValues] = useState({\n    username: \"\",\n    name: \"\",\n    email: \"\",\n    about: \"\",\n    password: \"\",\n    error: false,\n    success: false,\n    loading: false,\n    userData: process.browser && new FormData(),\n    username_for_photo: \"\"\n  });\n\n  const token = getCookie(\"token\");\n  const {\n    username,\n    name,\n    email,\n    about,\n    password,\n    error,\n    success,\n    loading,\n    username_for_photo,\n    userData\n  } = values;\n\n  const init = () => {\n    getProfile(token).then(data => {\n      if (data.error) {\n        setValues({ ...values, error: data.error });\n      } else {\n        setValues({\n          ...values,\n          username: data.username,\n          username_for_photo: data.username,\n          name: data.name,\n          email: data.email,\n          about: data.about\n        });\n      }\n    });\n  };\n\n  useEffect(() => {\n    init();\n    setValues({ ...values, userData: new FormData() });\n  }, []);\n\n  const handleChange = name => e => {\n    // console.log(e.target.value);\n\n    let value = name === \"photo\" ? e.target.files[0] : e.target.value;\n\n    userData.set(name, value);\n\n    setValues({\n      ...values,\n      [name]: value,\n      userData,\n      error: false,\n      success: false\n    });\n    // console.log(...userData)\n  };\n\n  const handleSubmit = e => {\n    e.preventDefault();\n    console.log(...userData);\n    setValues({ ...values, loading: true });\n    update(token, userData).then(data => {\n      if (data.error) {\n        setValues({\n          ...values,\n          error: data.error,\n          success: false,\n          loading: false\n        });\n      } else {\n        // console.log(data)\n        updateUser(data, () => {\n          setValues({\n            ...values,\n            // usernameImgSrc: data.username,\n            username: data.username,\n            name: data.name,\n            email: data.email,\n            about: data.about,\n            password: \"\",\n            success: true,\n            loading: false\n          });\n        });\n      }\n    });\n  };\n\n  const profileUpdateForm = () => (\n    <form onSubmit={handleSubmit} className=\"pl-5\">\n      <div className=\"form-group\">\n      <Button\n            variant=\"contained\"\n            color=\"default\"\n        \n            startIcon={<CloudUploadIcon />}\n          >\n        <label className=\"\">\n       \n            Featured photo\n            <input\n              onChange={handleChange(\"photo\")}\n              type=\"file\"\n              accept=\"image/*\"\n              hidden\n            />\n    \n        </label>\n        </Button>\n      </div>\n      <div className=\"form-group\">\n        <label className=\"text-muted\">Username</label>\n        <input\n          onChange={handleChange(\"username\")}\n          type=\"text\"\n          value={username}\n          className=\"form-control\"\n        />\n      </div>\n      <div className=\"form-group\">\n        <label className=\"text-muted\">Name</label>\n        <input\n          onChange={handleChange(\"name\")}\n          type=\"text\"\n          value={name}\n          className=\"form-control\"\n        />\n      </div>\n      <div className=\"form-group\">\n        <label className=\"text-muted\">Email</label>\n        <input\n          onChange={handleChange(\"email\")}\n          type=\"text\"\n          value={email}\n          className=\"form-control\"\n        />\n      </div>\n      <div className=\"form-group\">\n        <label className=\"text-muted\">About</label>\n        <textarea\n          onChange={handleChange(\"about\")}\n          type=\"text\"\n          value={about}\n          className=\"form-control\"\n        />\n      </div>\n      <div className=\"form-group\">\n        <label className=\"text-muted\">Password</label>\n        <input\n          onChange={handleChange(\"password\")}\n          type=\"password\"\n          value={password}\n          className=\"form-control\"\n        />\n      </div>\n      <div>\n        <Button variant=\"contained\" color=\"primary\" type=\"submit\">\n          Submit\n        </Button>\n      </div>\n    </form>\n  );\n\n  const showError = () => (\n    <div\n      className=\"alert alert-danger\"\n      style={{ display: error ? \"\" : \"none\" }}\n    >\n      {error}\n    </div>\n  );\n\n  const showSuccess = () => (\n    <div\n      className=\"alert alert-success\"\n      style={{ display: success ? \"\" : \"none\" }}\n    >\n      Profile updated\n    </div>\n  );\n\n  const showLoading = () => (\n    <div\n      className=\"alert alert-info\"\n      style={{ display: loading ? \"\" : \"none\" }}\n    >\n      Loading...\n    </div>\n  );\n\n  return (\n    <React.Fragment>\n      <div className=\"container\">\n        <div className=\"row\">\n          <div className=\"col-md-4 mt-5\">\n            <ReactImageFallback\n              src={`${API}/user/photo/${username_for_photo}`}\n              className=\"img img-fluid img-thumbnail mb-3\"\n              fallbackImage=\"/static/default.svg\"\n              style={{ maxHeight: \"auto\", maxWidth: \"100%\" }}\n              alt=\"user profile\"\n            />\n          </div>\n          <div className=\"col-md-8  mt-5\">\n            {showSuccess()}\n            {showError()}\n            {showLoading()}\n            {profileUpdateForm()}\n          </div>\n        </div>\n      </div>\n    </React.Fragment>\n  );\n};\n\nexport default ProfileUpdate;\n"]},"metadata":{},"sourceType":"module"}