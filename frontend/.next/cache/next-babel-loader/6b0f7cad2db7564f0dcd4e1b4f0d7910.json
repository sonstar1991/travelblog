{"ast":null,"code":"import _JSON$stringify from \"@babel/runtime-corejs2/core-js/json/stringify\";\nvar _jsxFileName = \"/Users/huirenchuah/Desktop/travelblog/frontend/pages/blogs/[slug].js\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport Layout from \"../../components/Layout\";\nimport Link from \"next/link\";\nimport Head from \"next/head\";\nimport { useState, useEffect } from \"react\";\nimport { singleBlog, listRelated, like, unlike } from \"../../actions/blog\";\nimport { API, DOMAIN, APP_NAME } from \"../../config\";\nimport moment from \"moment\";\nimport renderHTML from \"react-render-html\";\nimport SmallBlogCard from '../../components/blog/SmallBlogCard';\nimport Search from \"../../components/blog/Search\";\nimport DisqusThread from '../../components/DisqusThread';\nimport ReactImageFallback from 'react-image-fallback';\nimport { isAuth } from \"../../actions/auth\";\n\nconst SingleBlog = ({\n  blog,\n  query,\n  likes,\n  postedBy\n}) => {\n  const {\n    0: related,\n    1: setRelated\n  } = useState([]);\n  const {\n    0: userLike,\n    1: setUserLike\n  } = useState({\n    likes: 0,\n    like: false\n  });\n\n  const loadRelated = () => {\n    listRelated({\n      blog\n    }).then(data => {\n      if (data.error) {\n        console.log(data.error);\n      } else {\n        setRelated(data);\n      }\n    });\n  };\n\n  useEffect(() => {\n    loadRelated();\n  }, []);\n\n  const head = () => __jsx(Head, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 35\n    },\n    __self: this\n  }, __jsx(\"title\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 36\n    },\n    __self: this\n  }, blog.title, \" | \", APP_NAME), __jsx(\"meta\", {\n    name: \"description\",\n    content: blog.mdesc,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 39\n    },\n    __self: this\n  }), __jsx(\"link\", {\n    rel: \"canonical\",\n    href: `${DOMAIN}/blogs/${query.slug}`,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 40\n    },\n    __self: this\n  }), __jsx(\"meta\", {\n    property: \"og:title\",\n    content: `${blog.title}| ${APP_NAME}`,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 41\n    },\n    __self: this\n  }), __jsx(\"meta\", {\n    property: \"og:description\",\n    content: blog.mdesc,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 42\n    },\n    __self: this\n  }), __jsx(\"meta\", {\n    property: \"og:type\",\n    content: \"webiste\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 43\n    },\n    __self: this\n  }), __jsx(\"meta\", {\n    property: \"og:url\",\n    content: `${DOMAIN}/blogs/${query.slug}`,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 44\n    },\n    __self: this\n  }), __jsx(\"meta\", {\n    property: \"og:site_name\",\n    content: `${APP_NAME}`,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 45\n    },\n    __self: this\n  }), __jsx(\"meta\", {\n    property: \"og:image\",\n    content: `${API}/blog/photo/${blog.slug}`,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 47\n    },\n    __self: this\n  }), __jsx(\"meta\", {\n    property: \"og:image:secure_url\",\n    ccontent: `${API}/blog/photo/${blog.slug}`,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 48\n    },\n    __self: this\n  }));\n\n  const showBlogCategories = blog => blog.categories.map((c, i) => __jsx(Link, {\n    key: i,\n    href: `/categories/${c.slug}`,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 55\n    },\n    __self: this\n  }, __jsx(\"a\", {\n    className: \"btn btn-primary mr-1 ml-1 mt-3\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 56\n    },\n    __self: this\n  }, c.name)));\n\n  const showBlogTags = blog => blog.tags.map((t, i) => __jsx(Link, {\n    key: i,\n    href: `/tags/${t.slug}`,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62\n    },\n    __self: this\n  }, __jsx(\"a\", {\n    className: \"btn btn-outline-primary mr-1 ml-1 mt-3\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63\n    },\n    __self: this\n  }, t.name)));\n\n  const showRelatedBlog = () => {\n    return related.map((blog, i) => __jsx(\"div\", {\n      className: \"col-md-4\",\n      key: i,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 69\n      },\n      __self: this\n    }, __jsx(\"article\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 70\n      },\n      __self: this\n    }, __jsx(SmallBlogCard, {\n      blog: blog,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 71\n      },\n      __self: this\n    }))));\n  };\n\n  const showComments = () => {\n    return __jsx(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 79\n      },\n      __self: this\n    }, __jsx(DisqusThread, {\n      id: blog.id,\n      title: blog.title,\n      path: `/blog/${blog.slug}`,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 80\n      },\n      __self: this\n    }));\n  };\n\n  const likeToggle = () => {\n    let callApi = userLike ? unlike : like;\n\n    const userId = isAuth().blog.postedBy._id;\n\n    const blogId = blog._id;\n    const token = isAuth().token;\n    callApi(userId, token, blogId).then(data => {\n      if (data.error) {\n        console.log(data.error);\n      } else {\n        setUserLike({\n          like: !userLike,\n          likes: data.likes.length\n        });\n      }\n    });\n  };\n\n  return __jsx(React.Fragment, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107\n    },\n    __self: this\n  }, head(), __jsx(Layout, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110\n    },\n    __self: this\n  }, __jsx(\"main\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112\n    },\n    __self: this\n  }, __jsx(\"article\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"container-fluid\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114\n    },\n    __self: this\n  }, __jsx(\"section\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"row\",\n    style: {\n      marginTop: '-30px'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116\n    },\n    __self: this\n  }, __jsx(ReactImageFallback, {\n    src: `${API}/blog/photo/${blog.slug}`,\n    alt: blog.title,\n    fallbackImage: \"/static/default.svg\",\n    className: \"img img-fluid featured-image\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117\n    },\n    __self: this\n  }))), __jsx(\"section\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"container\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127\n    },\n    __self: this\n  }, __jsx(\"h1\", {\n    className: \" pb-3 pt-3 text-center font-weight-bold\",\n    style: {\n      maxWidth: '100%',\n      overflow: 'hidden'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128\n    },\n    __self: this\n  }, blog.title), __jsx(\"p\", {\n    className: \"lead mt-3 mark\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129\n    },\n    __self: this\n  }, \"Written by\", __jsx(Link, {\n    href: `/profile/${blog.postedBy.username}`,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131\n    },\n    __self: this\n  }, __jsx(\"a\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132\n    },\n    __self: this\n  }, \" \", blog.postedBy.username, \" \")), \"| Published \", moment(blog.updatedAt).fromNow()), __jsx(\"div\", {\n    className: \"pb-3\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138\n    },\n    __self: this\n  }, showBlogCategories(blog), showBlogTags(blog), _JSON$stringify(postedBy), __jsx(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142\n    },\n    __self: this\n  }), __jsx(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143\n    },\n    __self: this\n  }))))), __jsx(\"div\", {\n    id: \"blog-body\",\n    className: \"container\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149\n    },\n    __self: this\n  }, __jsx(\"h3\", {\n    onClick: likeToggle,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150\n    },\n    __self: this\n  }, likes, \" Like\"), __jsx(\"div\", {\n    className: \"col-md-12 lead\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151\n    },\n    __self: this\n  }, renderHTML(blog.body))), __jsx(\"div\", {\n    className: \"container\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155\n    },\n    __self: this\n  }, __jsx(\"h4\", {\n    className: \"text-center pt-5 pb-5 h2\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156\n    },\n    __self: this\n  }, \"Related blogs\"), __jsx(\"div\", {\n    className: \"row\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157\n    },\n    __self: this\n  }, showRelatedBlog())), __jsx(\"div\", {\n    className: \"container pt-5 pb-5\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160\n    },\n    __self: this\n  }, showComments())))));\n};\n\nSingleBlog.getInitialProps = ({\n  query\n}) => {\n  return singleBlog(query.slug).then(data => {\n    if (data.error) {\n      console.log(data.error);\n    } else {\n      return {\n        blog: data,\n        query,\n        likes: data.likes.length\n      };\n    }\n  });\n};\n\nexport default SingleBlog;","map":{"version":3,"sources":["/Users/huirenchuah/Desktop/travelblog/frontend/pages/blogs/[slug].js"],"names":["Layout","Link","Head","useState","useEffect","singleBlog","listRelated","like","unlike","API","DOMAIN","APP_NAME","moment","renderHTML","SmallBlogCard","Search","DisqusThread","ReactImageFallback","isAuth","SingleBlog","blog","query","likes","postedBy","related","setRelated","userLike","setUserLike","loadRelated","then","data","error","console","log","head","title","mdesc","slug","showBlogCategories","categories","map","c","i","name","showBlogTags","tags","t","showRelatedBlog","showComments","id","likeToggle","callApi","userId","_id","blogId","token","length","marginTop","maxWidth","overflow","username","updatedAt","fromNow","body","getInitialProps"],"mappings":"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","sourcesContent":["import Layout from \"../../components/Layout\";\nimport Link from \"next/link\";\nimport Head from \"next/head\";\nimport { useState, useEffect } from \"react\";\nimport { singleBlog, listRelated, like, unlike } from \"../../actions/blog\";\nimport { API, DOMAIN, APP_NAME } from \"../../config\";\nimport moment from \"moment\";\nimport renderHTML from \"react-render-html\";\nimport SmallBlogCard from '../../components/blog/SmallBlogCard'\nimport Search from \"../../components/blog/Search\"\nimport DisqusThread from '../../components/DisqusThread'\nimport ReactImageFallback from 'react-image-fallback'\nimport { isAuth } from \"../../actions/auth\";\n\n\nconst SingleBlog = ({ blog, query, likes, postedBy }) => {\n  const [related, setRelated] = useState([]);\nconst [userLike, setUserLike] =useState({likes:0, like:false})\n\n  const loadRelated = () => {\n      listRelated({ blog }).then(data => {\n          if (data.error) {\n              console.log(data.error);\n          } else {\n              setRelated(data);\n          }\n      });\n  };\n\n  useEffect(() => {\n      loadRelated();\n  }, []);\n\n  const head = () => (\n      <Head>\n          <title>\n              {blog.title} | {APP_NAME}\n          </title>\n          <meta name=\"description\" content={blog.mdesc} />\n          <link rel=\"canonical\" href={`${DOMAIN}/blogs/${query.slug}`} />\n          <meta property=\"og:title\" content={`${blog.title}| ${APP_NAME}`} />\n          <meta property=\"og:description\" content={blog.mdesc} />\n          <meta property=\"og:type\" content=\"webiste\" />\n          <meta property=\"og:url\" content={`${DOMAIN}/blogs/${query.slug}`} />\n          <meta property=\"og:site_name\" content={`${APP_NAME}`} />\n\n          <meta property=\"og:image\" content={`${API}/blog/photo/${blog.slug}`} />\n          <meta property=\"og:image:secure_url\" ccontent={`${API}/blog/photo/${blog.slug}`} />\n       \n      </Head>\n  );\n\n  const showBlogCategories = blog =>\n      blog.categories.map((c, i) => (\n          <Link key={i} href={`/categories/${c.slug}`}>\n              <a className=\"btn btn-primary mr-1 ml-1 mt-3\">{c.name}</a>\n          </Link>\n      ));\n\n  const showBlogTags = blog =>\n      blog.tags.map((t, i) => (\n          <Link key={i} href={`/tags/${t.slug}`}>\n              <a className=\"btn btn-outline-primary mr-1 ml-1 mt-3\">{t.name}</a>\n          </Link>\n      ));\n\n  const showRelatedBlog = () => {\n      return related.map((blog, i) => (\n          <div className=\"col-md-4\" key={i}>\n              <article>\n                  <SmallBlogCard blog={blog} />\n              </article>\n          </div>\n      ));\n  };\n\n  const showComments = () => {\n      return (\n          <div>\n              <DisqusThread id={blog.id} title={blog.title} path={`/blog/${blog.slug}`} />\n          </div>\n      );\n  };\n\n\n  const likeToggle =()=>{\n      let callApi = userLike ? unlike: like\n      const userId = isAuth().blog.postedBy._id\n      const blogId= blog._id\n      const token = isAuth().token\n      callApi(userId, token, blogId).then(data=>{\n          if(data.error){\n              console.log(data.error)\n          }\n          else{\n              setUserLike({\n                  like : !userLike,\n                  likes: data.likes.length\n              })\n          }\n      })\n  }\n\n\n\n  return (\n      <React.Fragment>\n           \n          {head()}\n          <Layout>\n       \n              <main>\n                  <article>\n                      <div className=\"container-fluid\">\n                          <section>\n                              <div className=\"row\" style={{ marginTop: '-30px' }}>\n                                  <ReactImageFallback\n                                      src={`${API}/blog/photo/${blog.slug}`}\n                                      alt={blog.title}\n                                      fallbackImage=\"/static/default.svg\"\n                                      className=\"img img-fluid featured-image\"\n                                  />\n                              </div>\n                          </section>\n\n                          <section>\n                              <div className=\"container\">\n                                  <h1 className=\" pb-3 pt-3 text-center font-weight-bold\" style={{maxWidth:'100%', overflow:'hidden'}}>{blog.title}</h1>\n                                  <p className=\"lead mt-3 mark\">\n                                      Written by\n                                      <Link href={`/profile/${blog.postedBy.username}`}>\n                                          <a> {blog.postedBy.username} </a>\n                                      </Link>\n                                       | Published {moment(blog.updatedAt).fromNow()}\n                                   \n                                  </p>\n\n                                  <div className=\"pb-3\">\n                                      {showBlogCategories(blog)}\n                                      {showBlogTags(blog)}\n                                      {JSON.stringify(postedBy)}\n                                      <br />\n                                      <br />\n                                  </div>\n                              </div>\n                          </section>\n                      </div>\n                   \n                      <div id=\"blog-body\" className=\"container\">\n                      <h3 onClick={likeToggle}>{likes} Like</h3> \n                              <div className=\"col-md-12 lead\">{renderHTML(blog.body)}</div>\n                 \n                      </div>\n\n                      <div className=\"container\">\n                          <h4 className=\"text-center pt-5 pb-5 h2\">Related blogs</h4>\n                          <div className=\"row\">{showRelatedBlog()}</div>\n                      </div>\n\n                      <div className=\"container pt-5 pb-5\">{showComments()}</div>\n                  </article>\n              </main>\n          </Layout>\n      </React.Fragment>\n  );\n};\n\n\nSingleBlog.getInitialProps = ({ query }) => {\n  return singleBlog(query.slug).then(data => {\n    if (data.error) {\n      console.log(data.error);\n    } else {\n\n      return { blog: data, query, likes:data.likes.length };\n    }\n  });\n};\n\nexport default SingleBlog;\n"]},"metadata":{},"sourceType":"module"}